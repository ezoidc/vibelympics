var F=["0️⃣","1️⃣","2️⃣","3️⃣","4️⃣","5️⃣","6️⃣","7️⃣","8️⃣","9️⃣"],j=($,z=2)=>{return Math.max(0,Math.floor($)).toString().padStart(z,"0").split("").map((K)=>F[Number(K)]??F[0]).join("")},U=($)=>{let z=Math.max(0,Math.floor($/1000)),G=Math.floor(z/60),J=z%60;return`${j(G)}\uD83D\uDFF0${j(J)}`},L=($)=>{let z=[...$];for(let G=z.length-1;G>0;G-=1){let J=Math.floor(Math.random()*(G+1)),K=z[G];z[G]=z[J],z[J]=K}return z};var V={chill:{key:"chill",emoji:"\uD83D\uDE42",pairs:6,cols:4,cardAura:"from-yellow-200/50 via-amber-200/40 to-orange-200/40",pool:["\uD83C\uDF49","\uD83C\uDF4B","\uD83C\uDF47","\uD83C\uDF4A","\uD83C\uDF53","\uD83C\uDF4D","\uD83E\uDD5D","\uD83C\uDF52","\uD83C\uDF51","\uD83C\uDF48"]},zest:{key:"zest",emoji:"\uD83E\uDD76",pairs:8,cols:4,cardAura:"from-orange-400/40 via-amber-500/35 to-rose-400/30",pool:["\uD83D\uDC8E","\uD83D\uDD37","\uD83D\uDD39","\uD83D\uDD35","\uD83C\uDF00","\uD83D\uDCA0","\uD83D\uDD2E","\uD83E\uDEAC","\uD83D\uDD2D","\uD83E\uDDFF"]},inferno:{key:"inferno",emoji:"\uD83D\uDC80",pairs:12,cols:6,cardAura:"from-rose-700/40 via-red-700/35 to-fuchsia-700/30",pool:["\uD83D\uDD35","\uD83D\uDD39","\uD83D\uDD18","⚫️","⚪️","\uD83D\uDD34","\uD83D\uDFE0","\uD83D\uDFE1","\uD83D\uDFE2","\uD83D\uDFE3","\uD83D\uDD37","\uD83D\uDD36","\uD83D\uDFE6","\uD83D\uDFE5","\uD83D\uDFE7","\uD83D\uDFEA","\uD83D\uDD33","\uD83D\uDD32","◼️","◻️","▪️","▫️","◽️","◾️"]}},S=["\uD83C\uDF89","\uD83C\uDFC6","✨","\uD83C\uDF8A","\uD83E\uDD73","\uD83D\uDCA5","\uD83C\uDF1F"],X=650,p=X+900,b=X+300,W=document.querySelector("#board"),B=document.querySelector("#timer"),I=document.querySelector("#moves"),h=document.querySelector("#best"),g=document.querySelector("#reset-btn"),A=Array.from(document.querySelectorAll(".difficulty-pill")),N=document.querySelector(".victory-pop");if(!W||!B||!I||!h||!g||!N)throw Error("Missing game nodes");var T=($)=>{let z=L($.pool).slice(0,$.pairs);return L(z.flatMap((G)=>[G,G]))},C="chill",f=()=>{let $=V[C];return{difficulty:C,deck:T($),matched:[],moves:0,elapsedMs:0,runningSince:null,bestTimes:{},flipped:[],locked:!1,victory:!1}},w=f(),m=()=>w.moves>0||w.matched.length>0||w.elapsedMs>0||w.flipped.length>0,u="⚠️❓➡️\uD83C\uDFAE♻️❗️",q=null,Q=[],H=($)=>new Promise((z)=>{window.setTimeout(z,$)}),k=($,z)=>{let G=Q[$];if(!G)return;if(!z){delete G.dataset.feedback;return}G.dataset.feedback=z},E=($,z,G)=>{$.forEach((J)=>k(J,z)),window.setTimeout(()=>{$.forEach((J)=>{let K=Q[J];if(!K)return;if(z==="good"&&K.dataset.state==="matched")return;delete K.dataset.feedback})},G)},_=()=>{B.textContent=`⏱️${U(w.elapsedMs)}`},Z=()=>{let $=w.matched.length/2;I.textContent=`\uD83D\uDD04${j(w.moves,2)} \uD83C\uDFAF${j($,2)}`},P=()=>{let $=w.bestTimes[w.difficulty];h.textContent=$?`\uD83C\uDFC6⏱️${U($)}`:"\uD83C\uDFC6⏱️0️⃣0️⃣\uD83D\uDFF00️⃣0️⃣"},R=()=>{A.forEach(($)=>{$.dataset.active=$.dataset.level===w.difficulty?"true":"false"})},v=()=>{let $=V[w.difficulty];W.innerHTML="",W.style.setProperty("--cols",$.cols.toString()),Q.length=0,w.deck.forEach((z,G)=>{let J=document.createElement("button");J.type="button",J.className=`card-shell relative w-full overflow-hidden rounded-3xl border border-white/10 bg-gradient-to-br ${$.cardAura} p-1 shadow-inner shadow-black/40 transition focus:outline-none focus-visible:ring-2 focus-visible:ring-fuchsia-400/60`,J.dataset.index=G.toString();let K=document.createElement("div");K.className="card-core absolute inset-0 flex h-full w-full items-center justify-center rounded-2xl bg-black/50 text-4xl";let O=document.createElement("div");O.className="card-face absolute inset-0 flex items-center justify-center text-4xl",O.textContent="❔";let M=document.createElement("div");if(M.className="card-face absolute inset-0 flex items-center justify-center text-5xl",M.style.transform="rotateY(180deg)",M.textContent=z,K.append(O,M),J.append(K),J.addEventListener("click",()=>s(G)),W.appendChild(J),Q.push(J),w.matched.includes(G))requestAnimationFrame(()=>Y(G,"matched"))})},D=()=>{if(w.runningSince===null)return;w.elapsedMs=Date.now()-w.runningSince,_()},n=($=!1)=>{if(w.runningSince!==null&&!$)return;if(!$)w.runningSince=Date.now(),w.elapsedMs=0;if(q)window.clearInterval(q);D(),q=window.setInterval(D,400)},y=()=>{if(q)window.clearInterval(q),q=null;if(w.runningSince!==null)w.elapsedMs=Date.now()-w.runningSince;w.runningSince=null},Y=($,z)=>{let G=Q[$];if(!G)return;G.dataset.state=z},l=($)=>{w.locked=!0,window.setTimeout(()=>{E($,"bad",800)},X),setTimeout(()=>{$.forEach((z)=>Y(z,"idle")),$.forEach((z)=>k(z)),w.flipped=[],w.locked=!1},p)},c=()=>{let $=new Set(w.matched),z=new Map;w.deck.forEach((G,J)=>{if($.has(J))return;let K=z.get(G)??[];K.push(J),z.set(G,K)});for(let G of z.values())if(G.length>=2)return[G[0],G[1]];return null},o=async($,z)=>{let G=Q[$],J=Q[z];if(!G||!J)return;G.click(),await H(X+120),J.click(),await H(b)},r=()=>{window.secretSolvePuzzle=async()=>{if(w.victory)return;let $=0;while(!w.victory&&$<200){if(w.locked){await H(X);continue}let z=c();if(!z)break;await o(z[0],z[1]),$+=1}}},d=()=>{N.innerHTML="";let $=document.createDocumentFragment();for(let z=0;z<60;z+=1){let G=document.createElement("span");G.textContent=S[Math.floor(Math.random()*S.length)]??"✨";let J=Math.random()*360-180,K=Math.random()*-260-60;G.style.left=`${50+Math.random()*40-20}%`,G.style.top=`${35+Math.random()*40-20}%`,G.style.fontSize=`${1+Math.random()*1.5}rem`,G.style.setProperty("--x",`${J}px`),G.style.setProperty("--y",`${K}px`),$.appendChild(G),window.setTimeout(()=>G.remove(),2400)}N.appendChild($)},i=()=>{w.victory=!0,y();let $=w.elapsedMs,z=w.bestTimes[w.difficulty];if(!z||$<z)w.bestTimes[w.difficulty]=$;P(),d()},a=()=>{if(w.matched.length===w.deck.length&&!w.victory)i()},s=($)=>{if(w.locked||w.victory)return;if(w.flipped.includes($)||w.matched.includes($))return;if(w.runningSince===null)n();if(w.flipped.push($),Y($,"flipped"),w.flipped.length===2){w.moves+=1;let[z,G]=w.flipped,J=w.deck[z],K=w.deck[G];if(!J||!K){w.flipped=[],w.locked=!1,Z();return}if(J===K){w.matched.push(z,G),setTimeout(()=>{Y(z,"matched"),Y(G,"matched")},250),window.setTimeout(()=>{E([z,G],"good",2000)},X),w.flipped=[],Z(),a();return}Z(),l([z,G]);return}Z()},x=($)=>{let z=V[$];y(),w.difficulty=$,w.deck=T(z),w.matched=[],w.moves=0,w.elapsedMs=0,w.runningSince=null,w.flipped=[],w.locked=!1,w.victory=!1,v(),_(),Z(),P(),R()};g.addEventListener("click",()=>{x(w.difficulty)});A.forEach(($)=>{$.addEventListener("click",()=>{let z=$.dataset.level;if(z&&z!==w.difficulty){if(m()&&!window.confirm(u))return;x(z)}})});r();v();_();Z();P();R();
